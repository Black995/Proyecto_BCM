import Crypto
import binascii
import rsa
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP


#Conviertiendo llaves
def file_open(file):
    key_file = open(file,'rb')
    key_data = key_file.read()
    key_file.close()
    return key_data

privkey = rsa.PrivateKey.load_pkcs1(file_open('privatekey.key'))

#





msj_enc = b' S3\xcc?\xbb\x08Q\x91\'\r#B\xe3\xaa5\xfb\x87\xbe\xf4\xe2n\xee\x02\x85\xd6\x9a\xef\xeaM;\x05pq\x8c9\xa8H\x00"d\xafPD\x13p\x08*\x02\x90)\x99;$\xcc\x15@\t\x0b\xc5D\xecz\xbd\xd0\xb2\xad\xd8\xf9d\xf5\xe5QWo6xb\xda\xbf\x18\x9f\xf3J\x8e\xee\xaeN\xb58C\xfa\xa0X\xe5\xcdz\xe2\x97\xab#\x8b\xc6|\xe7\\)\xb7\x00\xa6\x0b\x9fLOT\xec\x1f\x06T\xa2\xb7\x12\xe76\x8d\x9b\xfa\xc7\xa8\r\xfcXH\xd8-f\x1fS\x10\xfe\x82(\x04B{\x97lK\xf8\xed\x1f\x92\x00\x80\x14\x0b\xb7\xb3\xc3\xae\x85\x91=\xc99\xb3\xdf\x96G\x1f\xaf1-\xed\xd7\xabw<\xc7z\x8a)Sg\xad\x86e\xe8\x1c\t\xfd\x9d\xd2\xff,\x10\xfd)N\xbc$qX\x91E\x0b\xa0\xa8\x87:aZ\xd2\xd3\xc9?\xd3\xb0\xad]\xcd\xc0n\x95i\x81\xb5\x90\x80\tL\x1c\xc8\xc5,\xd2\n\xf2\x82\xc8\xbf\xc6\xb2\xfb\x1f\x0c\xba\xe0\xdc\xf6yl\x14\xac\xd0%'

signature = b'?TS\x13X\xe7\x8a\x06\xdeSe\x97\xf3\xe6\x0e\xe3\x8ci?\xf2`\x1f\x0eZL\xae\xc5\xc5\xaei\xfd<\x88\xa2\x04/\x87\xfb\x8cfO\xb4whD<5\x90\xa1\xef\x1d0{\xe3\xda\xb6\xeb:\xf2\xfdu\x8f,\xf9~F\xf2`\xe5\x00\x92V\xff\xf8\x8a\xc4\xc7\xebiu]\xc9\r\xc0.\x87r\x9f\x03\n\x8bwb\x9a\x1d\x8be\xd2NV\xca\xfeB\xdf\xd8\xc1\xd02\xba\x80@m\xd9\xb3j\xf0\x85:\xaa\x16etF\xb2\xa8\xa6\xdf^\xfd.o\xa8z\x00\xe3\x13<Q%\xf1B1\xf7^w`\xad,|{\xe6}TP\xee\x87\x0fq\x047\x87Y\xa8\xf2$9\xa2\x1d\xf6@4\xe5\x1c\xff\xb5\x1e]\xe9\xbcO\x12\xb7\x95\x8c%E\x0c\xf6\xfc\x1e\x04\xces\xaf\xd6\xc6\xcc \xff\xd1\xdfx\x17yhmU\xe4=CRm\xf7^\xac\xf2P\x8c\x01\xeb\xb4\x0b\xba\x91\xbd\x8f\xc6e^[?\x14F\x01B]\xd2\xda\x11\xab\xa0U\xbf\xce\x10`\x173\xb8\xbd\xfa!\xbb\xe5\x17\xc8'

pubPWC = rsa.PublicKey.load_pkcs1(file_open('publickeyPWC.key'))


try:
    rsa.verify(msj_enc,signature,pubPWC)
    mensaje = rsa.decrypt(msj_enc,privkey).decode('ascii')
    print(mensaje)
except:
    print('no')
'''



'''

